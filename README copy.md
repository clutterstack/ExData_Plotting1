---
title: "Untitled"
author: "clutterstack"
date: "November 2, 2015"
output: html_document
---
As indicated in the project instructions, this project makes use of the [“Individual household electric power consumption Data Set”](https://archive.ics.uci.edu/ml/datasets/Individual+household+electric+power+consumption) from the [UC Irvine Machine Learning Repository](http://archive.ics.uci.edu/ml/)

For use in this project, the data are available on the Exploratory Data Analysis website [here](https://d396qusza40orc.cloudfront.net/exdata%2Fdata%2Fhousehold_power_consumption.zip) (20MB)

The data must be unzipped into the same directory as the R scripts.

From the assignment instructions:

>**Description:** Measurements of electric power consumption in one household with a one-minute sampling rate over a period of almost 4 years. Different electrical quantities and some sub-metering values are available.
>
>The following descriptions of the 9 variables in the dataset are taken from the UCI web site:
>
>Date: Date in format dd/mm/yyyy
>
>Time: time in format hh:mm:ss
>
>Global_active_power: household global minute-averaged active power (in kilowatt)
>
>Global_reactive_power: household global minute-averaged reactive power (in kilowatt)
>
>Voltage: minute-averaged voltage (in volt)
>
>Global_intensity: household global minute-averaged current intensity (in ampere)
>
>Sub_metering_1: energy sub-metering No. 1 (in watt-hour of active energy). It corresponds to the kitchen, containing mainly a dishwasher, an oven and a microwave (hot plates are not electric but gas powered).
>
>Sub_metering_2: energy sub-metering No. 2 (in watt-hour of active energy). It corresponds to the
laundry room, containing a washing-machine, a tumble-drier, a refrigerator and a light.
>
>Sub_metering_3: energy sub-metering No. 3 (in watt-hour of active energy). It corresponds to an electric water-heater and an air-conditioner.

## Files
```plot1.R``` - R script to generate a histogram of Global active power 

```plot2.R``` - R script to generate a line plot of Global active power vs time

```plot3.R``` - R script to generate line plots of Sub_metering 1, 2, 3 vs time (black, red, blue)

```plot4.R``` - R script to generate a  2 x 2 grid of Plot 1, Voltage vs time, Plot 3, and Global reactive power vs time

The files generated by the four R scripts are:

`plot1.png`

`plot2.png`

`plot3.png`

`plot4.png`


## Preparation 
Some details regarding preparation to load the data follow. This info is not needed to run the scripts.

Reading the first few lines of ```household_power_consumption.txt``` with readLines() reveals that the first line contains column names, and that values are separated by semicolons.

We are warned in the project instructions that the datafile is large ("2,075,259 rows and 9 columns") and that we will only need values from the two days 2007-02-01 and 2007-02-02; while reading the file with a text editor and choosing lines manually (as per Community TA Al Warren's suggestion [here](https://class.coursera.org/exdata-034/forum/thread?thread_id=8#post-10)) seems more error-prone than loading all the data and subsetting with R according to the dates, I havenot found an easy way to read only the desired lines into memory. 

Here is the time-consuming procedure I settled on to get the needed lines programmatically (inspired by http://stackoverflow.com/a/7261212/5368865):

```
# Preallocate a vector for the line numbers to read in. For generality, make it at least as
# long as we're told the data file is.
keep  <- vector(length = 2100000) # 2.1 million FALSEs

# Data are in a local file
filename <- "household_power_consumption.txt"

# Open connection to read from the file
fileconn <- file(filename, "r")

# Take some time to loop through and find the lines containing the dates we're interested in
# Note the format of the date, with no leading zeros

i <- 0L
while (length(s <- scan(fileconn, "", nmax=1, quiet=TRUE))) {
  i <- i + 1L
  # Here want to read first item in line, and if it corresponds to 2007-02-01 or 
  # 2007-02-02, note the line number. 
  thing <- grepl("^1/2/2007|^2/2/2007", s)
  if (thing == TRUE) {
    keep[i] <- TRUE
  }
}
close(fileconn)

# Have a look at the logical vector indicating which 
sum(keep)
#[1] 2880

min(which(keep))
#[1] 66638 

max(which(keep))
#[1] 69517
```
The first index it gives is 66638 and last is 69517 -- 2 days times 1440 minutes per day = 2880 entries -- looks right. In the script, load 2880 rows, skipping the first 66637 rows.

We've been warned that missing values are indicated by ```?``` so specify this in the arguments to read.table.


